{% extends "base.html" %}
{% block title %}Redaguoti vartotoją{% endblock %}
{% block content %}

<!-- Navigacija viršuje -->
<div class="mb-4">
  <a href="{{ url_for('admin.admin_dashboard') }}" class="btn btn-secondary me-2">← Atgal į admin skydelį</a>
  <a href="{{ url_for('admin.manage_users') }}" class="btn btn-secondary me-2">Vartotojų valdymas</a>
  <a href="{{ url_for('main.profile') }}" class="btn btn-secondary">Profilis</a>
</div>

<div class="center-wrapper">
  <div class="main-content glass-card" style="max-width: 420px;">
    <h2 style="margin-bottom: 22px; color: #fff; text-shadow: 0 2px 8px rgba(40, 50, 60, 0.22); font-weight: 800;">
      Redaguoti: {{ user.full_name }}
    </h2>
    <form method="POST">
      {{ form.hidden_tag() }}

      <!-- Rolė pasirinkimas -->
      <div class="floating-label" style="margin-bottom: 22px;">
        <select name="role" id="role" class="input" style="background: #fff; color: var(--card-bg);" required>
          <option value="student" {% if user.is_student %}selected{% endif %}>Studentas</option>
          <option value="teacher" {% if user.is_teacher %}selected{% endif %}>Dėstytojas</option>
        </select>
        <label for="role">Rolė</label>
      </div>

      <!-- Aktyvumo žymė -->
      <div style="margin-bottom: 22px; display: flex; align-items: center; gap: 10px;">
        <input type="checkbox" name="is_active" id="is_active" style="width: 20px; height: 20px;" {% if user.is_active %}checked{% endif %}>
        <label for="is_active" style="color: #111; font-size: 1.08em; font-weight: 700; margin: 0;">
          Aktyvus
        </label>
      </div>

      <!-- Studijų programa tik studentui -->
      {% if user.is_student %}
      <div class="floating-label" style="margin-bottom: 22px;">
        <select name="program_id" id="program_id" class="input" style="background: #fff; color: var(--card-bg);">
          {% for program in programs %}
          <option value="{{ program.id }}" {% if user.student_info and user.student_info.study_program_id == program.id %}selected{% endif %}>
            {{ program.name }}
          </option>
          {% endfor %}
        </select>
        <label for="program_id">Studijų programa</label>
      </div>
      {% endif %}

      <div style="display: flex; gap: 12px; justify-content: flex-end; margin-top: 12px;">
        <button type="submit" class="button" style="padding: 8px 22px; font-size: 1em; min-width: 90px;">Išsaugoti</button>
        <a href="{{ url_for('admin.manage_users') }}" class="button glass-btn" style="color: var(--accent-dark); background: transparent; padding: 8px 22px; font-size: 1em; min-width: 90px;">
          Atgal
        </a>
      </div>
    </form>
  </div>
</div>
{% endblock %}
